<div><div><br/></div><div><span style="font-weight: bold;">来源网址：</span> <a href="http://www.cnblogs.com/mq0036/p/3382732.html">http://www.cnblogs.com/mq0036/p/3382732.html</a></div><div><a href="http://blog.csdn.net/syzobelix/article/details/40054095">http://blog.csdn.net/syzobelix/article/details/40054095</a></div><div><a href="https://blog.csdn.net/imred/article/details/45441457">https://blog.csdn.net/imred/article/details/45441457</a></div><div><a href="http://lib.csdn.net/article/cplusplus/23583">http://lib.csdn.net/article/cplusplus/23583</a></div><div><a href="https://zhuanlan.zhihu.com/p/28041871?utm_source=com.evernote&amp;utm_medium=social">https://zhuanlan.zhihu.com/p/28041871?utm_source=com.evernote&amp;utm_medium=social</a></div><div><a href="http://blog.csdn.net/yanzi1225627/article/details/40518223">http://blog.csdn.net/yanzi1225627/article/details/40518223</a></div><div><span style="font-weight: bold;">1.数组的简介</span></div><div><span style="-en-paragraph:true;">&nbsp; &nbsp; &nbsp;数组大小（元素个数）一般在编译时决定，也有少部分编译器可以运行时动态绝对数组</span>大小，比如icpc（intel C++编译器）</div><div style="-en-paragraph:true;"><span style="font-weight: bold;">1.1 数组名的意义</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">数组名的本质是数组第一个元素的首地址，也是数组的首地址。<span style="color: rgb(158, 0, 243);">数组名所代表的地址是在编译阶段确定的，</span><span style="color: rgb(158, 0, 243);">因此数组名是一个地址常量，但不是常变量，是符号常量</span><span style="color: rgb(158, 0, 243);">，文字常量的一种</span>。重要的事情说三遍，<span style="color: rgb(158, 0, 243);">数组名本身不是一个变量，也就不可以寻址，且不允许为数组名赋值</span>。假设定义数组：</span></div><div style="-en-paragraph:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int A[10];</div></div></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">那么再定义一个引用：</span></div><div style="-en-paragraph:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int* &amp;r=A;</div></div></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">就是错误的，因为变量A是一个文字常量，不可寻址。如果要建立数组A的引用，应该这样定义：</span></div><div style="-en-paragraph:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int* const &amp;r=A;</div></div></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">此时，现在数据区开辟一个无名临时变量，将数组A代表的地址常量拷贝到该变量中，再将常引用r与此变量进行绑定。</span>此外，定义一个数组A，则A、&amp;A[0]、A+0是等价。</div><div style="-en-paragraph:true;">关于数组名，还需注意如下几点。</div><ul><li><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">在sizeof()运算中，<span style="color: rgb(158, 0, 243);">数组名代表的是全体数组元素</span>，而不是哪个单个元素。例如，定义int A[5]，生成Win32的程序，sizeof(A)就等于5*sizeof(int)=5*4=20。</span></div></li><li><div style="-en-paragraph:true;"><span style="-en-paragraph:true;"><span style="color: rgb(158, 0, 243);">A与&amp;A的结果在数值上是一样的，但是A与&amp;A的数据类型却不同</span>。A的类型是int[4]，近似于int* const，&amp;A的类型则是int(*)[4]。它们在概念上是不一样的，这就直接导致A+1与&amp;A+1的结果完全不一样。</span></div></li><li><div style="-en-paragraph:true;"><span style="-en-paragraph:true;"><span style="color: rgb(158, 0, 243);">为变量建立引用的语法格式是type&amp; ref，因为数组A的类型是int[4]，因此为A建立引用的是int (&amp;rA)[4]=A;</span></span></div></li></ul><div style="-en-paragraph:true;"><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(51, 51, 51); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">示例程序如下：</span></div><div style="-en-paragraph:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &lt;iostream&gt;</div><div>using namespace std;</div><div>int main(){</div><div>&nbsp;&nbsp;&nbsp;&nbsp;int A[4]={1,2,3,4};</div><div>&nbsp;&nbsp;&nbsp;&nbsp;int B[4]={5,6,7,8};</div><div>&nbsp;&nbsp;&nbsp;&nbsp;int (&amp;rA)[4]=A; //建立数组A的引用</div><div><br/></div><div><br/></div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;A:&quot;&lt;&lt;A&lt;&lt;endl;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;&amp;A:&quot;&lt;&lt;&amp;A&lt;&lt;endl;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;A+1:&quot;&lt;&lt;A+1&lt;&lt;endl;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;&amp;A+1:&quot;&lt;&lt;&amp;A+1&lt;&lt;endl;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;B:&quot;&lt;&lt;B&lt;&lt;endl;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;rA:&quot;&lt;&lt;rA&lt;&lt;endl;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;&quot;&amp;rA:&quot;&lt;&lt;&amp;rA&lt;&lt;endl;}</div></div></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">运行结果：</span></div><div style="-en-paragraph:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>A:0013F76C</div><div>&amp;A:0013F76C</div><div>A+1:0013F770</div><div>&amp;A+1:0013F77C</div><div>B:0013F754</div><div>rA:0013F76C</div><div>&amp;rA:0013F76C</div></div></div><div style="-en-paragraph:true;"><br/></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">1.2数组的初始化</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">&nbsp; &nbsp; &nbsp; &nbsp;定义数组的时候，为数组元素赋初值，叫做数组的初始化。可以为一维数组指定初值，也可以为多维数组指定初值。例如。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">如果一个数组是某个类对象的数据成员，C++语言并没有提供特别的手段来初始化这个数组。只能在构造函数中分别指定数组元素的值，或者是用memset等其它方式来初始化数组。特别的，不能再构造函数的初始化列表中为对象的书组成员进行初始化。</span></div><div style="-en-paragraph:true;"><br/></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">2.指针</span></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">2.1指针的定义</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">指针在C/C++中就是用来存放地址值的变量，相应的数据类型成为指针类型。在32位平台上，任何指针类型所占用的空间都是都是4字节。比如sizeof(int*)、sizeof(double*)、sizeof(float*)等的值都为4。</span></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">2.2定义指针的形式</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">定义指针的形式是：type* p;其中type是指针所指向的对象的数据类型，而*则是指针的标志，p是指针变量的名字。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">由于C++中允许定义复合数据类型，因此指向复合数据类型对象的指针的定义方式可能较为复杂。理解指针，关键是理解指针的类型和指针所指向的数据的类型。例如：</span></div><div><span style="font-weight: bold;">2.3指针的初始化</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">定义指针变量之后，指针变量的值一般是随机值，这样的值对应的地址不是指针变量可以合法访问的地址。指针变量的值合法化的途径通常有两个，</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">一是让指针指向一个已经存在的变量，如：</span></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">2.4指针可以参与的运算</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">由于指针是一个变量，所以指针可以参与一些运算。假设定义指针int* p，指针p能够参与的运算有：</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（1）解引用运算，即获取指针所指的内存地址处的数据，表达式为*p;</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">如果指针指向的是一个结构或者类的对象，那么解引用之后访问对象的成员可以采用两种形式：(*p).mem或p-&gt;mem。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（2）取地址运算，即获取指针变量的地址，表达式为&amp;p，其数据类型为int**;</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（3）指针与整数相加减。表达式p+i（或者p-i），实际上是让指针递增或递减的移动i个int型变量的距离。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（4）两个指针相减，如p-q，其结果是两个指针所存储的地址之间的int型数据的个数。</span></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">2.5注意指针的有效性</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">使用指针的关键，就是让指针变量指向一个它可以合法访问的内存地址，如果不知道它指向何处，请置为空指针NULL或者((void*)0)。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">在某些情况下，指针的值开始是合法的，以后随着某些操作的进行，它变成了非法的值。考察如下程序。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">输出结果是0，并非想象中的25。原因是函数SomeFunction()运行结束之后，局部变量nNumber已经被清空，其占有的空间在离开函数后归还给系统，之后有分配给函数UseStack()中的局部变量arr。因此指针pNumber的解引用后的值变成了0。所以，要想正确的使用指针，必须保证指针所指向单元的有效性。</span></div><div style="-en-paragraph:true;"><br/></div><div style="-en-paragraph:true;"><span style="font-weight: bold;">3.数组与指针的关系</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">数组名代表的是数组的首地址，而数组A的某个元素A[i]可以解释成*(A+i)，所以数组名本身可以理解为一个指针（地址），只不过是指针常量。所以，在很多情况下，数组与指针的用法是相同的。但是数组与指针本质上存在一些重要的区别。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（1）数组空间是静态分配的，编译时决定大小。而指针在定义时，可以没有合法访问的地址空间，也就是悬挂的野指针。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（2）数组名代表的是一个指针常量，企图改变数组名所代表的地址的操作都是非法的。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">例如如下代码：</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（3）函数形参中的数组被解释为指针。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">考察如下程序：</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（5）在概念上，指针同一维数组相对应。多维数组也是存储在连续的存储空间，而将多维数组当做一维数据看待时，可以有不同的分解方式。考察如下程序。</span></div><div><br/></div><div style="-en-paragraph:true;"><span style="font-weight: bold;-en-paragraph:true;">数组是指针？</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">最近在做数据结构课设，其中一个函数发生了令人费解的错误，简化后的代码如下：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &lt;stdio.h&gt;</div><div>int main()</div><div>{</div><div>char foo[] = &quot;abcde&quot;;</div><div>char **bar = &amp;foo;</div><div>printf(&quot;%c\n&quot;, *(*bar));</div><div>return 0;</div><div>}</div></div><div>程序执行到 printf 语句后便会挂掉，调试时会提示一个SIGSEGV信号，根据原来的经验，这时程序试图访问本不应该访问的内存。原来在 C 语言课堂上老师经常提到数组就是一个指针，指针也可以像数组那样用使用中括号的方式来进行内存访问。以这样的想法来分析前面的程序：foo 是一个字符指针，即 foo 的值即为“abcde”的首字符“a”的地址，*foo 即为 ‘a’；那么 foo 这个指针一定存在某个内存单元，&amp;foo获得这个内存单元的地址，即 pfoo 是指向 foo 的指针，那么*pfoo 得到 foo，*(*pfoo)应该得到‘a’了；这样理解的话，程序是不应该有问题的。</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">下面我们使用指针代替数组来实现上面的程序：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>#include &lt;stdio.h&gt;</div><div>#include &lt;stdlib.h&gt;</div><div>int main()</div><div>{</div><div>char *foo = (char *)malloc(sizeof (char) * 2);</div><div>*foo = &apos;a&apos;;</div><div>*(foo + 1) = 0;</div><div>char **pfoo = &amp;foo;</div><div>printf(&quot;%c\n&quot;, *(*pfoo));</div><div>return 0;</div><div><br/></div></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">程序这次运行结果和预料的相同，输出一个字母a。由此可见，数组就是指针，这种说法是错误的。</span></div><div style="-en-paragraph:true;"><span style="font-weight: bold;-en-paragraph:true;">数组是静态常量指针（static/Compile-time constant）？</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">有人认为数组是一个静态常量，即数组名代表一个静态的地址值，在编译时确定，下面代码可以证伪这种说法</span></div><div>int main()</div><div>{</div><div>char foo[] = {&apos;a&apos;};</div><div>static char *p = foo;</div><div>return 0;</div><div>}</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">使用 gcc 编译时会有以下错误：</span></div><div>error: initializer element is not constant</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">可见数组名并不是代表一个静态量，并非地址常量。如果定义 foo 时加上 static 限定符，编译就会通过，此时数组名才代表了一个静态量。</span></div><div style="-en-paragraph:true;"><span style="font-weight: bold;-en-paragraph:true;">数组是动态常量指针（const/Runtime constant）？</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">请看以下代码：</span></div><div>int main()</div><div>{</div><div>char foo[] = {&apos;a&apos;};</div><div>char * const bar;</div><div>char *baz;</div><div>foo = baz;</div><div>bar = baz;</div><div>return 0;</div><div>}</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">gcc 编译时错误信息为：</span></div><div>error: incompatible types when assigning to type &apos;char[1]&apos; from type &apos;char *&apos;</div><div>error: assignment of read-only variable &apos;bar&apos;</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">1 2 两处出错信息并不相同，若数组为动态常量指针，出错信息应像 2 那样。</span></div><div style="-en-paragraph:true;"><br/></div><div style="-en-paragraph:true;"><span style="font-weight: bold;-en-paragraph:true;">数组是什么？</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">数组既不是静态常量，也不是指针，那么数组是什么？</span></div><h3>左值和右值</h3><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">首先补充一些左值和右值的知识，引用《C专家编程》中的一段话：</span></div><blockquote><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">出现在赋值符左边的符号有时被称为左值，出现在赋值符右边的符号有时被称为右值。编译器为每个变量分配一个地址（左值）。这个地址在编译时可知，而且该变量在运行时一直保存于这个地址。相反，存储于变量中的值（它的右值）只有在运行时才可知。如果需要用到变量中存储的值，编译器就发出指令从指定地址读入变量值并将它存于寄存器中。</span></div></blockquote><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">我对左值的理解和书上有些区别，我把这里的“符号”称为“对象”，每一个符号都代表一个对象，对象与地址是一一对应的。即如果声明了 int a，那么 a 作为一个左值时，a 即代表这个保存在某个特定的地址的对象，对这个对象赋值即为把值放在这个特定的地址；a 作为右值时即代表 a 的内容，就是一个单纯的值，而不是对象。一个值是不能作为左值的，比如一个常数 1, 1 = a 这样的赋值语句是无法编译通过的。在我看来，“左值”义同“对象”，“右值”义同“值”，所以下面“左值”和“对象”指的是相同的东西。但是“左值”又有一个子集：“可修改的左值”，只有这个子集中的东西才能放在赋值号左边，因此我认为将引用中的第一句话修改为“出现在赋值符左边的符号有时被称为可修改的左值”更能表达其实际的意思。为什么要引出这个子集，为的就是要把数组分出来，数组是左值，但并不是可修改的左值，因此你也不能直接把数组名放在等号左边进行赋值。</span></div><h3>数组就是数组！</h3><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">我先把结论放在这里，然后在进行分析：数组就是数组，一个数组名就代表一个数组对象，这个对象内可以有一个或多个元素，每个元素类型都相同；正如 int 就是 int，一个 int 变量名就代表一个 int 类型对象。看到这里，你可能要笑了，这不是什么都没说吗，谁不知道数组是这个意思啊，我想知道数组和指针什么关系。其实对数组的认识就是这样一个返璞归真过程，看我来慢慢解释。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">以下代码：</span></div><div><br/></div><div>int main()</div><div>{</div><div>int foo[] = {1};</div><div>int bar = 1;</div><div>return 0;</div><div>}</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">使用 gcc 将其汇编并以 intel 格式输出汇编语言文件：</span></div><div>gcc -S -masm=intel 1.c</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">关键部分为：</span></div><div>mov DWORD PTR [esp+8], 1</div><div>mov DWORD PTR [esp+12], 1</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">esp+8 位置就是那个 int foo[]，esp+12 位置就是那个 int bar。可见，给 int 数组的赋值时就像给一个 int 变量赋值一样，并没用指针来进行间接访问，这个 int 数组对象 foo 的内存地址在编译时就确定了，是 esp+8；正如那个 int 对象 bar 一样，它的内存地址在编译时也确定了，是esp+12。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">以示区别，我将下面代码同样以汇编语言输出：</span></div><div><br/></div><div>#include &lt;stdlib.h&gt;</div><div>int main()</div><div>{</div><div>int *foo = (int *)malloc(sizeof (int));</div><div>*foo = 1;</div><div>return 0;</div><div>}</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">汇编的关键部分为：</span></div><div>mov DWORD PTR [esp], 4</div><div>call _malloc</div><div>mov DWORD PTR [esp+28], eax</div><div>mov eax, DWORD PTR [esp+28]</div><div>mov DWORD PTR [eax], 1</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">前两句为 foo 分配内存空间，第三句将分配的内存空间地址值赋给 foo，foo 的地址为 esp+28，编译时已知。下面是赋值部分，首先从 foo 那里得到地址值，然后向这个地址赋值，这里可以看出和给数组赋值的差别，给数组赋值时是将值直接赋到了数组中，而不用从哪里得到数组的地址。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">由上面可以看出，数组更像一个普通的变量，编译时就知道了其地址，可以直接赋值。</span></div><h3>数组作为左值</h3><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">数组不能放在赋值号左边，但数组仍可以作为一个左值或者说对象出现在语句中，一个重要的例子就是取地址操作：&amp;。取地址操作 &amp;的操作数必须是一个左值，而不能是一个右值。比如一个变量int a = 1，&amp;a 就可以得到 a 的地址，但 &amp;1 是非法的，一个单纯的数值是没有地址的。那么对于一个int foo[]，&amp;foo 会返回一个什么样的值呢？自然是一个指向数组的指针咯，下面的程序可以看出来：</span></div><div>int main()</div><div>{</div><div>int foo[1];</div><div>int bar[1];</div><div>bar = &amp;foo;</div><div>return 0;</div><div>}</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">那个赋值语句一定会触发一个的错误，我们可以根据编译输出来确定它们的类型，错误为：</span></div><div>error: incompatible types when assigning to type &apos;int[1]&apos; from type &apos;int (*)[1]&apos;</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">没错，&amp;foo 返回数据类型为 int (*)[1]，就是一个指向数组的指针。指向数组？指向数组的哪里呢？指向数组对象首地址，正如一个指向 int 对象的指针指向那个 int 对象占有的两个或四个内存单元的首地址一样。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">把 &amp;foo 赋给一个普通的指针是可以的，不过会触发一个 warning，因为int * 与 int (*)[1] 并不相容。赋值后普通指针的值与 &amp;foo 的值是相同的，都是数组对象的首地址，只是普通指针把这块内存当做 int 对象处理而已。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">由于 C 语言是弱类型语言，你把 &amp;foo 赋给int **********bar 或者 int *baz都是可以的，都不会导致 error，只会导致 warning，此时你打印出 *bar 或者 *baz 的值都是 foo 中第一个整数的值（前提是指针和数组占用空间大小相等）。正如文章开头的代码那样，以这个整数的值作为一个地址值进行间接访问（*(*bar)）就会导致非法访问的错误。</span></div><h3>数组作为右值</h3><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">数组作为右值时会发生什么？返回数组对象内的所有值自然不可能，因此 C 语言中采取的方法是数组作为右值时返回对象中元素类型的指针，指针指向第一个元素，类似上一个例子：</span></div><div>int main()</div><div>{</div><div>int foo[1];</div><div>int bar[1];</div><div>bar = foo;</div><div>return 0;</div><div>}</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">出错信息为：</span></div><div>error: incompatible types when assigning to type &apos;int[1]&apos; from type &apos;int *&apos;</div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">foo 作为右值时返回了一个 int *，就是这个特性给人造成了数组就是指针的假象。</span></div><h2>总结</h2><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">数组作为左值和数组作为右值时的区别造成了无数人的困惑与误解：foo 作为右值时确实等价于一个指针，因为数组无法像普通对象那样返回它的值，它的元素可能有成百上千个，但作为一个左值时——比如作为取地址操作符的操作数时，数组就是作为一个数组对象而出现的，而不是指针，取地址返回一个指向数组的指针，而不是指向指针的指针。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">一句话总结就是：数组就是数组，有着自己的特性。</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">（题外话：从生成的汇编语言看，用指针来访问内存实际上并不比使用数组来访问内存快，反而是慢了）</span></div><div style="-en-paragraph:true;"><span style="-en-paragraph:true;">转载请注明来源</span> <a href="http://blog.csdn.net/imred/article/details/45441457" style="-en-paragraph:true;">http://blog.csdn.net/imred/article/details/45441457</a></div><div><br/></div><div><br/></div><div><a href="http://www.cnblogs.com/mq0036/p/3382732.html" style="font-weight: bold; text-decoration-line: none;">数组指针和指针数组的区别</a></div><div><span style="color: rgb(0, 0, 0); font-weight: bold; text-decoration-line: none;">定义：</span></div><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: bold;">数组指针（也称行指针）</span></div><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; 定义 int (*p)[n];</span>()优先级高，首先说明p是一个指针，指向一个整型的一维数组，这个一维数组的长度是n，也可以说是p的步长。也就是说执行p+1时，p要跨过n个整型数据的长度。如要将二维数组赋给一指针，应这样赋值：</div><div style="-evernote-webclip:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int a[3][4];</div><div>int (*p)[4]; //该语句是定义一个数组指针，指向含4个元素的一维数组。</div><div>p=a;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//将该二维数组的首地址赋给p，也就是a[0]或&amp;a[0][0]</div><div>p++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//该语句执行过后，也就是p=p+1;p跨过行a[0][]指向了行a[1][]</div></div></div><div style="-evernote-webclip:true;">所以数组指针也称指向一维数组的指针，亦称行指针。</div><div style="-evernote-webclip:true;"><span style="-evernote-webclip:true;">&nbsp; &nbsp; &nbsp; &nbsp;</span>这里有个有意思的话题值得探讨一下：平时我们定义指针不都是在数据类型后面加上指针变量名么？这个指针p 的定义怎么不是按照这个语法来定义的呢？也许我们应该这样来定义p：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int (*)[4] p;</div></div><div style="-evernote-webclip:true;">其实数组指针的原型确实就是这样子的，只不过为了方便与好看把指针变量p2 前移了而已。你私下完全可以这么理解这点。虽然编译器不这么想。</div><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: bold;">指针数组</span></div><div style="-evernote-webclip:true;"><span style="-evernote-webclip:true;">&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-style: normal; font-weight: normal;">定义 int *p[n];</span>[]优先级高，先与p结合成为一个数组，再由int*说明这是一个整型指针数组，它有n个指针类型的数组元素。这里执行p+1时，则p指向下一个数组元素，这样赋值是错误的：p=a；因为p是个不可知的表示，只存在p[0]、p[1]、p[2]...p[n-1],而且它们分别是指针变量可以用来存放变量地址。但可以这样 *p=a; 这里*p表示指针数组第一个元素的值，a的首地址的值。如要将二维数组赋给一指针数组:</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int *p[3];</div><div>int a[3][4];</div><div>p++; //该语句表示p数组指向下一个数组元素。注：此数组每一个元素都是一个指针</div><div>for(i=0;i&lt;3;i++)</div><div>p[i]=a[i]</div></div><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: normal;">这里int *p[3] 表示一个一维数组内存放着三个指针变量，分别是p[0]、p[1]、p[2]</span>所以要分别赋值。这样两者的区别就豁然开朗了，数组指针只是一个指针变量，似乎是C语言里专门用来指向二维数组的，它占有内存中一个指针的存储空间。指针数组是多个指针变量，以数组形式存在内存当中，占有多个指针的存储空间。<span style="color: rgb(158, 0, 243);">还需要说明的一点就是，同时用来指向二维数组时，其引用和用数组名引用都是一样的。</span>比如要表示数组中i行j列一个元素：*(p[i]+j)、*(*(p+i)+j)、(*(p+i))[j]、p[i][j]优先级：()&gt;[]&gt;*</div><div style="-evernote-webclip:true;"><span style="font-weight: bold;-evernote-webclip:true;">图形理解：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>A)&nbsp; &nbsp;int *p1[10];//指针数组</div><div>B)&nbsp; &nbsp;int (*p2)[10];//数组指针</div></div><div style="-evernote-webclip:true;"><br/></div><div style="text-align: center;-evernote-webclip:true;"><en-media hash="6c1b11b81640b0f18853f4bbe71ead3d" type="image/png"/></div><h2 style="margin: 0px; font-size: 18px; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; list-style-type: none; vertical-align: middle; border: 0px; padding: 0px;"><span style="font-size: 18px; font-variant: normal; line-height: 40px;">再论a 和&amp;a 之间的区别</span></h2><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: normal;">既然这样，那问题就来了。前面我们讲过a 和&amp;a 之间的区别，现在再来看看下面的代码：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int main()</div><div>{</div><div>&nbsp;&nbsp;&nbsp;char a[5]={&apos;A&apos;,&apos;B&apos;,&apos;C&apos;,&apos;D&apos;};</div><div>&nbsp;&nbsp;&nbsp;char (*p3)[5] = &amp;a;</div><div>&nbsp;&nbsp;&nbsp;char (*p4)[5] = a;</div><div>&nbsp;&nbsp;&nbsp;return 0;</div><div>}</div></div><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: normal;">上面对p3 和p4 的使用，哪个正确呢？p3+1 的值会是什么？p4+1 的值又会是什么？毫无疑问，p3 和p4 都是数组指针，指向的是整个数组。</span><span style="color: rgb(158, 0, 243); font-style: normal; font-weight: normal;">&amp;a 是整个数组的首地址，a是数组首元素的首地址，其值相同但意义不同。</span><span style="font-style: normal; font-weight: normal;">在C 语言里，赋值符号“=”号两边的数据类型必须是相同的，如果不同需要显示或隐式的类型转换。p3 这个定义的“=”号两边的数据类型完全一致，而p4 这个定义的“=”号两边的数据类型就不一致了。</span><span style="color: rgb(158, 0, 243); font-style: normal; font-weight: normal;">左边的类型是指向整个数组的指针，右边的数据类型是指向单个字符的指针</span><span style="font-style: normal; font-weight: normal;">。在Visual C++6.0 上给出如下警告：</span></div><div style="-evernote-webclip:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>warning C4047: &apos;initializing&apos; : &apos;char (*)[5]&apos; differs in levels of indirection from &apos;char *&apos;。</div></div></div><div style="-evernote-webclip:true;">还好，这里虽然给出了警告，但由于&amp;a 和a 的值一样，而变量作为右值时编译器只是取变量的值，所以运行并没有什么问题。不过我仍然警告你别这么用。最好通过<span style="-evernote-webclip:true;">强制转换</span>将其修改为。<span style="-evernote-webclip:true;">如:char (*p2)[5]=(char (*)[5])a。</span></div><div style="-evernote-webclip:true;"><span style="-evernote-webclip:true;">&nbsp; &nbsp; &nbsp; &nbsp;</span>既然现在清楚了p3 和p4 都是指向整个数组的，那p3+1 和p4+1 的值就很好理解了。但是如果修改一下代码，把数组大小改小点，会有什么问题？p3+1 和p4+1 的值又是多少呢？</div><div style="-evernote-webclip:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int main()</div><div>{</div><div>&nbsp;&nbsp;&nbsp;char a[5]={&apos;A&apos;,&apos;B&apos;,&apos;C&apos;,&apos;D&apos;};</div><div>&nbsp;&nbsp;&nbsp;char (*p3)[<font color="#9E00F3">3</font>] = &amp;a;</div><div>&nbsp;&nbsp;&nbsp;char (*p4)[<font color="#9E00F3">3</font>] = a;</div><div>&nbsp;&nbsp;&nbsp;return 0;</div><div>}</div></div></div><div style="-evernote-webclip:true;">甚至还可以把代码再修改，把数组大小改大点：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int main()</div><div>{</div><div>&nbsp;&nbsp;&nbsp;char a[5]={&apos;A&apos;,&apos;B&apos;,&apos;C&apos;,&apos;D&apos;};</div><div>&nbsp;&nbsp;&nbsp;char (*p3)[<font color="#9E00F3">10</font>] = &amp;a;</div><div>&nbsp;&nbsp;&nbsp;char (*p4)[<font color="#9E00F3">10</font>] = a;</div><div>&nbsp;&nbsp;&nbsp;return 0;</div><div>}</div></div><div style="-evernote-webclip:true;">此时，这个时候又会有什么样的问题？</div><div style="-evernote-webclip:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>error C2440: &apos;initializing&apos; : cannot convert from &apos;char (*)[5]&apos; to &apos;char (*)[3]&apos;</div><div>error C2440: &apos;initializing&apos; : cannot convert from &apos;char (*)[5]&apos; to &apos;char (*)[10]</div></div></div><div style="-evernote-webclip:true;"><span style="-evernote-webclip:true;">p3+1 和p4+1 的值</span>测试，程序为</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int main()</div><div>{</div><div>&nbsp;&nbsp;char a[5]={&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;};</div><div>&nbsp;&nbsp;char (*p1)[5]= &amp;a;</div><div>&nbsp;&nbsp;char (*p2)[5]=(char (*)[5])a;</div><div>&nbsp;&nbsp;printf(&quot;a=%d\n&quot;,a);</div><div>&nbsp;&nbsp;printf(&quot;a=%c\n&quot;,a[0]);</div><div>&nbsp;&nbsp;printf(&quot;p1=%c\n&quot;,**p1);</div><div>&nbsp;&nbsp;printf(&quot;p2=%c\n&quot;,**p2);</div><div>&nbsp;&nbsp;printf(&quot;p1+1=%c\n&quot;,**(p1+1));</div><div>&nbsp;&nbsp;printf(&quot;p2+1=%c\n&quot;,**(p2+1));</div><div>&nbsp;&nbsp;return 0;</div><div>}</div></div><div style="-evernote-webclip:true;"><span style="font-style: normal; font-weight: normal;">输出:</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a=1638208</div><div>a=a</div><div>p1=a</div><div>p2=a</div><div>p1+1=?</div><div>p2+1=?</div></div><div style="-evernote-webclip:true;">结论:根据指针类型及所指对象,表示指针大小,每次加1,表示增加指针类型大小的字节.</div><div style="-evernote-webclip:true;"><br/></div><div style="-evernote-webclip:true;"><span style="font-weight: bold;">经典问题</span></div><div style="-evernote-webclip:true;"><span style="font-weight: bold;">问题1：</span></div><div style="-evernote-webclip:true;"><div><span style="font-style: normal; font-weight: normal;">先看下面这个例子：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>struct Test</div><div>{</div><div>&nbsp;&nbsp;&nbsp;int Num;</div><div>&nbsp;&nbsp;&nbsp;char *pcName;</div><div>&nbsp;&nbsp;&nbsp;short sDate;</div><div>&nbsp;&nbsp;&nbsp;char cha[2];</div><div>&nbsp;&nbsp;&nbsp;short sBa[4];</div><div>}*p;</div></div><div>假设p 的值为0x100000。如下表表达式的值分别为多少？</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>p + 0x1 = 0x___ ?</div><div>(unsigned long)p + 0x1 = 0x___?</div><div>(unsigned int*)p + 0x1 = 0x___?</div></div><div><span style="font-style: normal; font-weight: normal;">我相信会有很多人一开始没看明白这个问题是什么意思。其实我们再仔细看看，这个知识点似曾相识。一个指针变量与一个整数相加减，到底该怎么解析呢？</span>还记得前面我们的表达式“a+1”与“&amp;a+1”之间的区别吗？其实这里也一样。指针变量与一个整数相加减并不是用指针变量里的地址直接加减这个整数。这个整数的单位不是byte 而是元素的个数。所以：p + 0x1 的值为0x100000+sizof（Test）*0x1。至于此结构体的大小为20byte，前面的章节已经详细讲解过。所以p +0x1 的值为：0x100014.(unsigned long)p + 0x1 的值呢？这里涉及到强制转换，将指针变量p 保存的值强制转换成无符号的长整型数。任何数值一旦被强制转换，其类型就改变了。所以这个表达式其实就是一个无符号的长整型数加上另一个整数。所以其值为：0x100001。(unsigned int*)p + 0x1 的值呢？这里的p 被强制转换成一个指向无符号整型的指针。所以其值为：0x100000+sizof（unsigned int）*0x1，等于0x100004。</div><div><span style="font-weight: bold;-evernote-webclip:true;">问题2：</span></div><div><span style="font-style: normal; font-weight: normal;">上面这个问题似乎还没啥技术含量，下面就来个有技术含量的：在x86 系统下，其值为多少？</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>intmain()</div><div>{</div><div>&nbsp;&nbsp;&nbsp;int a[4]={1,2,3,4};</div><div>&nbsp;&nbsp;&nbsp;int *ptr1=(int *)(&amp;a+1);//指向a数组后面的内存单元，&amp;a+1表示向后移16个存储单元</div><div>&nbsp;&nbsp;int *ptr2=(int *)((int)a+1);//表示a的存储单元的地址增加一个字节</div><div>&nbsp;&nbsp;&nbsp;printf(&quot;%x,%x&quot;,ptr1[-1],*ptr2);//ptr1[-1]其实指向的是a数组的最后一个单元，*ptr1则表示a数组的地址后移一个字节之后的4个连续存储单元所存储的值</div><div>&nbsp;&nbsp;return 0;</div><div>}</div></div><div>根据上面的讲解，&amp;a+1 与a+1 的区别已经清楚。</div><div><span style="font-style: normal; font-weight: normal;">ptr1：将&amp;a+1 的值强制转换成int*类型，赋值给int* 类型的变量ptr，ptr1 肯定指到数组a 的下一个int 类型数据了。ptr1[-1]被解析成*(ptr1-1)，即ptr1 往后退4 个byte。所以其值为0x4。</span></div><div><span style="font-style: normal; font-weight: normal;">ptr2：按照上面的讲解，(int)a+1 的值是元素a[0]的第二个字节的地址。然后把这个地址强制转换成int*类型的值赋给ptr2，也就是说*ptr2 的值应该为元素a[0]的第二个字节开始的连续4 个byte 的内容。</span></div><div><span style="font-style: normal; font-weight: normal;">其内存布局如下图：</span></div><div style="text-align: center;"><en-media hash="798a85680c6c8ec0e1d1b51968393ff0" type="image/png"/></div><div><span style="font-style: normal; font-weight: normal;">好，问题就来了，这连续4 个byte 里到底存了什么东西呢？也就是说元素a[0],a[1]里面的值到底怎么存储的。这就涉及到系统的大小端模式了，如果懂汇编的话，这根本就不是问题。既然不知道当前系统是什么模式，那就得想办法测试。大小端模式与测试的方法在第一章讲解union 关键字时已经详细讨论过了，请翻到彼处参看，这里就不再详述。我们可以用下面这个函数来测试当前系统的模式。</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>int checkSystem()</div><div>{</div><div>union check</div><div>{</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int i;</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char ch;</div><div>} c;</div><div>c.i = 1;</div><div>return (c.ch ==1);//如果当前系统为大端模式这个函数返回0；如果为小端模式，函数返回1。</div><div>}</div></div><div><span style="font-style: normal; font-weight: normal;">如果当前系统为大端模式这个函数返回0；如果为小端模式，函数返回1。也就是说如果此函数的返回值为1 的话，*ptr2 的值为0x2000000。如果此函数的返回值为0 的话，*ptr2 的值为0x100。</span></div></div><div style="-evernote-webclip:true;"><br/></div><div style="margin-top: 10px;line-height: 1.5;-evernote-webclip:true;"/><div style="-evernote-webclip:true;"><h2><br/></h2><div><br/></div><div><br/></div></div><div style="-evernote-webclip:true;"><div><a href="http://blog.csdn.net/syzobelix/article/details/40054095" style="font-style: normal; font-weight: normal; text-decoration: none;">C语言的数组名和对数组名取地址</a></div><div><div><br/></div><table><colgroup><col style="width: 130px;"/></colgroup><tbody><tr><td width="670px"><div><a href="http://blog.csdn.net/zdcsky123/article/details/6517811" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank">C语言的数组名和对数组名取地址</a></div><div><span style="font-style: normal; font-weight: normal;">转自：</span><a href="http://www.360doc.com/content/12/0313/18/4186481_194063111.shtml#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank">http://www.360doc.com/content/12/0313/18/4186481_194063111.shtml#</a></div><div><span style="font-style: normal; font-weight: normal;">相信不少的</span><a href="http://lib.csdn.net/base/c" style="font-style: normal; font-weight: bold; text-decoration: none;" target="_blank" title="C语言知识库">C语言</a><span style="font-style: normal; font-weight: normal;">初学者都</span><span style="font-style: normal; font-weight: normal;">知道</span><span style="font-style: normal; font-weight: normal;">，数组名相当于指针，指向数组的首地址，而函数名相当于函数指针，指向函数的入口地址。</span></div><div><span style="font-style: normal; font-weight: normal;">现在有这样一个问题，如果对数组名取地址，那得到的会是什么呢？很多人立刻会想到：给指针取地址，就是指针的指针，</span></div><div><span style="font-style: normal; font-weight: normal;">即二级指针嘛！当然这样的结论是错误的，不然这篇笔记也就没有意义了。</span></div><div><span style="font-style: normal; font-weight: normal;">下面我们来逐步分析，下面是一段验证这个问题的代码</span></div><div><div><span style="font-style: normal; font-weight: normal;">Code:</span></div><ol><li><div><span style="font-style: normal; font-weight: normal;">#include&lt;stdio.h&gt;</span> <span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">main() &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">a[10]; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;printf(</span><span style="font-style: normal; font-weight: normal;">&quot;a:/t%p/n&quot;</span><span style="font-style: normal; font-weight: normal;">, a); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;printf(</span><span style="font-style: normal; font-weight: normal;">&quot;&amp;a:/t%p/n&quot;</span><span style="font-style: normal; font-weight: normal;">, &amp;a); &nbsp; &nbsp; &nbsp; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;printf(</span><span style="font-style: normal; font-weight: normal;">&quot;a+1:/t%p/n&quot;</span><span style="font-style: normal; font-weight: normal;">, a+1); &nbsp; &nbsp; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;printf(</span><span style="font-style: normal; font-weight: normal;">&quot;&amp;a+1:/t%p/n&quot;</span><span style="font-style: normal; font-weight: normal;">, &amp;a+1); &nbsp; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">return</span> <span style="font-style: normal; font-weight: normal;">0; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">} &nbsp;</span></div></li></ol></div><div><span style="font-style: normal; font-weight: normal;">大家可以编译运行一下，我的输出的结果是：</span></div><div><div><span style="font-style: normal; font-weight: normal;">Code:</span></div><ol><li><div><span style="font-style: normal; font-weight: normal;">/* &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">a: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0012FF20</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&amp;a: &nbsp; &nbsp; &nbsp; &nbsp; 0012FF20</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">a+1: &nbsp; &nbsp; &nbsp; &nbsp;0012FF24</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&amp;a+1: &nbsp; &nbsp; &nbsp; 0012FF48</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">*/</span> <span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li></ol></div><div><span style="font-style: normal; font-weight: normal;">a和&amp;a指向的是同一块地址，但他们+1后的效果不同，a+1是一个元素的内存大小（增加4），而&amp;a+1增加的是整个数组的内存</span>大小（增加40）。既a和&amp;a的指向和&amp;a[0]是相同的，但性质不同！</div><div><span style="font-style: normal; font-weight: normal;">读到这里，有很多朋友已经明白其中的机制了，如果还是有些模糊，请继续往下看</span></div><div><div><span style="font-style: normal; font-weight: normal;">Code:</span></div><ol><li><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">main() &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">a[10]; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;printf(</span><span style="font-style: normal; font-weight: normal;">&quot;%d/n&quot;</span><span style="font-style: normal; font-weight: normal;">,</span><span style="font-style: normal; font-weight: bold;">sizeof</span><span style="font-style: normal; font-weight: normal;">(a)); &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">return</span> <span style="font-style: normal; font-weight: normal;">0; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">} &nbsp;</span></div></li></ol></div><div><span style="font-style: normal; font-weight: normal;">这段代码会输出整个数组的内存大小，而不是首元素的大小，由此我们是否联系到，sizeof（a）这里的a和</span></div><div><span style="font-style: normal; font-weight: normal;">&amp;a有些相同之处呢？！&nbsp; 是的，没错，&amp;a取都得是整个数组的地址！既数组名取地址等价于对数组取地址。</span></div><div><span style="font-style: normal; font-weight: normal;">好了，让我们总结一下，如果你还是不太理解，不用担心，下面的概念很清晰</span></div><div><span style="font-style: normal; font-weight: normal;">其实a和 &amp;a结果都是数组的首地址，但他们的类型是不一样。</span></div><div><span style="font-style: normal; font-weight: normal;">a表示&amp;a[0],也即对数组首元素取地址，a+1表示首地址+sizeof(元素类型)。</span></div><div><span style="font-style: normal; font-weight: normal;">&amp;a虽然值为数组首元素地址，但类型为：类型 (*)[数组元素个数],所以&amp;a+1大小为：首地址+sizeof(a)。</span></div><div><span style="font-style: normal; font-weight: normal;">还有这篇文章最初提到的指针的指针的那个错误结论，其实即使不懂上述内容，也应该判断出结论是错误的，大家应该在了解数组名</span></div><div><span style="font-style: normal; font-weight: normal;">即是数组的首地址的同时，也要知道，数组名</span><span style="font-style: normal; font-weight: normal;">仅仅</span><span style="font-style: normal; font-weight: normal;">是“</span><span style="font-style: normal; font-weight: normal;">相当</span><span style="font-style: normal; font-weight: normal;">”</span><span style="font-style: normal; font-weight: normal;">于指针，而并非真的是指针，数组名是只是个常量（一个值为数组首元素</span></div><div><span style="font-style: normal; font-weight: normal;">地址的常量），所以不能进行++或者--运算。而常量更是无法取地址的，而之所以有&amp;a，其实这里的a的意义早已经不是当初那个数组</span></div><div><span style="font-style: normal; font-weight: normal;">名了，它此时代表了整个数组。</span></div><div><br/></div><div><span style="font-style: normal; font-weight: normal;">C语言数组首地址和数组名取地址区别</span></div><div><span style="font-style: normal; font-weight: normal;">2010年11月24日 11:51</span></div><table><colgroup><col style="width: 948px;"/></colgroup><tbody><tr><td><div><p style="margin:0px;padding:0px;font-size:12px;color:rgb(89,89,89);line-height:normal;"/><p style="margin:0px;padding:0px;line-height:normal;"/><div><div><span style="font-style: normal; font-weight: normal;">申明：本文系原创，转载时请注明出处，本人保留追究责任的权利。</span></div><div><span style="font-style: normal; font-weight: normal;">原文地址：http://hi.baidu.com/surfmygod/blog/item/53d44914cdb8a5d6a7ef3f13.html</span></div><p style="margin:0px;padding:0px;"/><div><span style="font-style: normal; font-weight: normal;">本文适用于机器为32位，编译器为</span><span style="font-style: normal; font-weight: normal;">VC6.0</span><span style="font-style: normal; font-weight: normal;">。</span></div><div><span style="font-style: normal; font-weight: normal;">先来看下面一个例子：</span></div><div><span style="font-style: normal; font-weight: normal;">main()</span></div><div><span style="font-style: normal; font-weight: normal;">{</span></div><div><span style="font-style: normal; font-weight: normal;">int a[5]={0x11121314,0x21222324,0x31323334,0x41424344,0x51525354};</span></div><div><span style="font-style: normal; font-weight: normal;">int *ptr1=(int *)(&amp;a+1);</span></div><div><span style="font-style: normal; font-weight: normal;">int *ptr2=(int *)(a+1);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;%x,%x&quot;,ptr1[-1],*ptr2);</span></div><div><span style="font-style: normal; font-weight: normal;">getch();</span></div><div><span style="font-style: normal; font-weight: normal;">}</span></div><div><span style="font-style: normal; font-weight: normal;">打印输出的结果是多少？第4行&amp;a是不是写错了？数组名怎么还取地址呢？</span></div><div><span style="font-style: normal; font-weight: normal;">你可以试着在软件中编译运行一下，结果是51525354，21222324，没错，就是它了。你可以试着写以下程序</span></div></div><div><span style="font-style: normal; font-weight: normal;">再在计算机中编译运行下：</span></div><div><span style="font-style: normal; font-weight: normal;">main()</span></div><div><span style="font-style: normal; font-weight: normal;">{</span></div><div><span style="font-style: normal; font-weight: normal;">int a[5]={0x11121314,0x21222324,0x31323334,0x41424344,0x51525354};</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;%p\n%p\n&quot;,a,&amp;a);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;%d\n%d\n&quot;,sizeof(a),sizeof(&amp;a));</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;%p\n%p&quot;,&amp;a+1,a+1);</span></div><div><span style="font-style: normal; font-weight: normal;">getch();</span></div><div><span style="font-style: normal; font-weight: normal;">}</span></div><div><span style="font-style: normal; font-weight: normal;">你可以看到前两行a和&amp;a打印的结果是一样的（比如0012FF6C），后两行的结果是都是20，而&amp;a+1的结果是0012FF6C，</span></div><div><span style="font-style: normal; font-weight: normal;">即a的起始地址后移20字节。看到这里对于a和&amp;a的区别是不是有些眉目了？不错，a和&amp;a的值虽然一样，但是前者表示</span></div><div><span style="font-style: normal; font-weight: normal;">的是数组a的首地址，</span><span style="font-style: normal; font-weight: normal;">进阶为数组元素长度，而后者也是表示数组a的首地址（或许有些人不同意我这个观点，对地址</span></div><div><span style="font-style: normal; font-weight: normal;">取地址应该是指向指针</span><span style="font-style: normal; font-weight: normal;">的指针呀。</span><span style="font-style: normal; font-weight: normal;">不过你注意了没有，a和&amp;a值是一样的，试想如果这里表示的是指向指针的指针，</span></div><div><span style="font-style: normal; font-weight: normal;">那么a的地址和指向a的</span><span style="font-style: normal; font-weight: normal;">指针的地址可能一样么？</span></div><div><span style="font-style: normal; font-weight: normal;">两个指针都指向数组首地址，怎么会是指向指针的指针？还有一点需要强调，对一个指针进行sizeof运算，32位系统</span></div><div><span style="font-style: normal; font-weight: normal;">下应该得到4，</span><span style="font-style: normal; font-weight: normal;">而对数组名进行sizeof运算得到的结果却是20，这说明了什么？很显然，数组名虽然能够拿出来代表</span></div><div><span style="font-style: normal; font-weight: normal;">一个地址，但是它和指针还是</span><span style="font-style: normal; font-weight: normal;">有区别的，对它进行sizeof运算也不会得到指针的大小。不信？你可以试试sizeof(&amp;a[0])</span></div><div><span style="font-style: normal; font-weight: normal;">和sizeof(a)，看看结果是不是相同），</span></div><div><span style="font-style: normal; font-weight: normal;">但是是将整个数组作为一个对象来看待的，进阶为整个数组长度。也就是说，a和&amp;a虽然值相同，但是a是将所有数组</span></div><div><span style="font-style: normal; font-weight: normal;">元素看成</span><span style="font-style: normal; font-weight: normal;">一个个不同的个体来对待的，而&amp;a是将整个数组作为一个整体来对待的。这里要强调的是，a+1和&amp;a[1]其实</span></div><div><span style="font-style: normal; font-weight: normal;">是一样的，都是代表</span><span style="font-style: normal; font-weight: normal;">a数组向后偏移一个元素的地址，你可以再用sizeof关键字打印一下两个的值。但是a和&amp;a[0]的</span></div><div><span style="font-style: normal; font-weight: normal;">意义相同么？若打印地址的话，</span><span style="font-style: normal; font-weight: normal;">两者确实是一样的，但是你也用sizeof打印下两者，一样么？再试试a+0呢？很显然，</span></div><div><span style="font-style: normal; font-weight: normal;">a和a+0是有区别的，但是a+0和&amp;a[0]</span><span style="font-style: normal; font-weight: normal;">是含义相同的。所以，你可以说a+i和&amp;a[i]含义相同，但是绝不能说a和&amp;a[0]</span></div><div><span style="font-style: normal; font-weight: normal;">或a+0含义相同。所以&amp;a+1后移20位为&amp;a+sizeof(&amp;a)，</span><span style="font-style: normal; font-weight: normal;">而a+1却是a+sizeof(a[i])。</span></div><div><span style="font-style: normal; font-weight: normal;">（《</span><a href="http://lib.csdn.net/base/c" style="font-style: normal; font-weight: bold; text-decoration: none;" target="_blank" title="C语言知识库">c语言</a><span style="font-style: normal; font-weight: normal;">深度解剖》认为在32为系统下sizeof(&amp;a)的值仍为4，我觉得是不对的。他觉得是VC6.0错了，</span><span style="font-style: normal; font-weight: normal;">其实不止VC，</span></div><div><span style="font-style: normal; font-weight: normal;">其他很多编译器得到的结果也不会是4，这说明a和&amp;a在C中本来就不是作为指针来用的，只是具有指针的部分性质而已。）</span></div><div><br/></div><div><br/></div><div><span style="font-style: normal; font-weight: normal;">ptr1是将&amp;a+1强转为int类型指针，此时打印ptr1[-1]即将ptr指针前移sizeof(int)个字节，故打印结果是5。</span></div><div><span style="font-style: normal; font-weight: normal;">这样一来后面的也明了了，</span><span style="font-style: normal; font-weight: normal;">a+1的值为在数组a的首地址上后移sizeof(int)个字节，然后强转为int类型指针</span></div><div><span style="font-style: normal; font-weight: normal;">（其实强转并没有改变什么，原来类型即为整型指针，</span><span style="font-style: normal; font-weight: normal;">可以去掉强转），最后输出结果为21222324。</span></div><div><br/></div><div><span style="font-style: normal; font-weight: normal;">再想一下，如果将第一例第五行改为int *ptr2=(int *)((int)a+1);打印结果会是什么？</span></div><div><span style="font-style: normal; font-weight: normal;">这里要考虑数据在计算机中的存储模式：大端模式和小端模式。解释一下：</span></div><div><span style="font-style: normal; font-weight: normal;">大端模式（Big_endian）：字数据的高字节存储在低地址中，而字数据的低字节则存放在高地址中。</span></div><div><span style="font-style: normal; font-weight: normal;">小端模式（Little_endian）：字数据的高字节存储在高地址中，而字数据的低字节则存放在低地址中。</span></div><div><span style="font-style: normal; font-weight: normal;">在大端模式下，a在计算机中存储如下（从低地址到高地址，一个十六进制数代表内存的一个字节，下同）：</span></div><div><span style="font-style: normal; font-weight: normal;">0x11 0x12 0x13 0x14 0x21 0x22 0x23 0x24 0x31 0x32 0x33 0x34 0x41 0x42 0x43 0x44 0x51 0x52 0x53 0x54</span></div><div><span style="font-style: normal; font-weight: normal;">在小端模式下，a在计算机中存储如下：</span></div><div><span style="font-style: normal; font-weight: normal;">0x14 0x13 0x12 0x11 0x24 0x23 0x22 0x21 0x34 0x33 0x32 0x31 0x44 0x43 0x42 0x41 0x54 0x53 0x52 0x51</span></div><div><span style="font-style: normal; font-weight: normal;">(int)a表示将a的首地址强转为整型数据（若原来是0012FF6C，转换后仍为0012FF6C，但是这时已经不是表示地址而是一个</span></div><div><span style="font-style: normal; font-weight: normal;">十六进制整型数了），这时+1代表整型数(int)a加1（变为0012FF6D），再把结果强转为整形指针，故指向的数据地址为0012FF6D，</span></div><div><span style="font-style: normal; font-weight: normal;">即上述存储去的第二个字节开始处。此时输出*ptr2，即输出a数组存储区中第二到第五字节组成的一个整型数，若为大端模式则输出</span></div><div><span style="font-style: normal; font-weight: normal;">12131421，若为小端模式则输出24111213。</span></div><p style="margin:0px;padding:0px;"/></div><div><span style="font-style: normal; font-weight: normal;">补充说明下，在vc6.0上，上面sizeof(&amp;a)才是20,而在GCC ，以及之后的vc版本（如vs2005及之后版本）则是将&amp;a完全视作一个指针，</span><span style="font-style: normal; font-weight: normal;">sizeof(&amp;a)为4 (32位机器)</span></div><div><h1><span style="font-style: normal; font-weight: normal;">二维数组名问题</span></h1><div><h1><br/></h1><div><h1><span style="font-style: normal; font-weight: normal;">转自： &nbsp;</span><a href="http://zhidao.baidu.com/question/386658092.html" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank">http://zhidao.baidu.com/question/386658092.html</a></h1><div><h1><br/></h1></div></div></div></div><div><span style="font-style: normal; font-weight: normal;">int *p1[3], (*p2)[2]， ** p， a[3][2];a) p1=a;是否语法正确？ b) p2=a;呢？ ？ 为什么？请详述原因。 c) p=a; 是否正确？？？可不可以认为二维数组名是一个指向指针的指针变量？</span></div><div style="white-space:pre-wrap;word-wrap:break-word;margin-top:0px;margin-bottom:0px;padding:0px;font-family:Arial;zoom:1;"/><div style="white-space:pre-wrap;word-wrap:break-word;margin-top:0px;margin-bottom:0px;padding:0px;font-family:Arial;zoom:1;"/><div style="white-space:pre-wrap;word-wrap:break-word;margin-top:0px;margin-bottom:0px;padding:0px;font-family:Arial;zoom:1;"/><div><span style="font-style: normal; font-weight: normal;">a)不正确！p1是指针数组，他的元素是指针，但是他是数组，数组名不可以写在赋值号左边。b)正确！p2是数组指针，他可以指向一个数组。在这里他可以指向一个包含2个元素的数组。而二维数组的本质是指针数组，每个元素是一个 数组指针（这点是核心）。a[3][2] 的实质是：一个有3个元素的数组，每个元素是数组指针，该指针指向一个含有2个元素的数组（因为内存是个大的1维数组，所有东西在内存里都是1维数组）。#include &lt;stdio.h&gt;int main(void){ int (*p1)[2]; int a[3][2]; p1=a; printf(&quot;%p, %p\n&quot;,p1+2,a+2); while(1); return 0;}以上程序可以说明b是正确的。c：不正确！如果你做p++那么p的值只增加了4（一个指针大小），而不是增加8（一个 p[2] 大小）</span></div><div style="white-space:pre-wrap;word-wrap:break-word;margin-top:0px;margin-bottom:0px;padding:0px;font-family:Arial;zoom:1;"/><div style="white-space:pre-wrap;word-wrap:break-word;margin-top:0px;margin-bottom:0px;padding:0px;font-family:Arial;zoom:1;"/><div><span style="font-style: normal; font-weight: normal;">其他网址：</span> <a href="http://topic.csdn.net/u/20100106/15/e5fa8fa6-555e-4729-a435-d1f8fdac5612.html" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank">http://topic.csdn.net/u/20100106/15/e5fa8fa6-555e-4729-a435-d1f8fdac5612.html</a></div><div><span style="font-style: normal; font-weight: normal;">示例程序：</span></div><div><span style="font-style: normal; font-weight: normal;">#if 1</span></div><div><span style="font-style: normal; font-weight: normal;">#include &lt;stdio.h&gt;</span></div><div><span style="font-style: normal; font-weight: normal;">#include &lt;stdlib.h&gt;</span></div><div><span style="font-style: normal; font-weight: normal;">int main()</span></div><div><span style="font-style: normal; font-weight: normal;">{</span></div><div><span style="font-style: normal; font-weight: normal;">int a[] = {1,2,3,4,5};</span></div><div><span style="font-style: normal; font-weight: normal;">int *p1 = (int *)(a+1);</span></div><div><span style="font-style: normal; font-weight: normal;">int *p2 = (int *)(&amp;a+1);</span></div><div><span style="font-style: normal; font-weight: normal;">int *p3 = (int *)((int)a + 1);</span></div><div><span style="font-style: normal; font-weight: normal;">int *p4 = a;</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;a is %p \n&quot;,a);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;&amp;a is %p \n&quot;,&amp;a);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;sizeof(a) = %d\n&quot;,sizeof(a));</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;sizeof(&amp;a) = %d\n&quot;,sizeof(&amp;a));</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;sizeof(p4) = %d \n&quot;,sizeof(p4));</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;p1 = %p \n&quot;,p1);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;p2 = %p \n&quot;,p2);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;*p1 = %d\n&quot;,*p1);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;p2[-1] = %d\n&quot;,p2[-1]);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;*p3 = %d \n&quot;,*p3);</span></div><div><span style="font-style: normal; font-weight: normal;">printf(&quot;*(p2-1) = %d \n&quot;,*(p2-1));</span></div><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;</span></div><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; system(&quot;PAUSE&quot;);</span></div><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; return 0;</span></div><div><span style="font-style: normal; font-weight: normal;">}</span></div><div><span style="font-style: normal; font-weight: normal;">#endif</span></div><div><br/></div></td></tr></tbody></table><div><br/></div></td></tr></tbody></table><div><br/></div></div></div><div><br/></div><div><br/></div><div style="-en-paragraph:true;"><br/></div><div><br/></div><div><br/></div><div><br/></div><div><h1><span style="font-size: 29pt;"><br/></span></h1></div><div><br/></div><div><br/></div><div><br/></div><div><h1><span style="font-style: normal; font-weight: 700;">从5个维度来看C语言指针(指针就是个纸老虎)</span></h1><div><br/></div></div><div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 400;">小伙伴们，对C语言编程有疑问的，可以加微信交流：poo_poo或者扫描我的头像，验证时请注明是“知友”</span></div><div><span style="font-style: normal; font-weight: 400;">之前我写过一篇文章：</span> <a href="https://zhuanlan.zhihu.com/p/25093473" style="font-style: normal; font-weight: 400; text-decoration: none;">从四个属性的角度来理解C语言的指针也许会更好理解</a><span style="font-style: normal; font-weight: 400;">。在那篇文章中，我给指针总结出了4个属性，分别是</span><span style="font-style: normal; font-weight: 700;">“有用数据的地址、有用数据的名字、有用数据的值以及有用数据的类型”，</span><span style="font-style: normal; font-weight: 400;">应该帮助了不少人，但现在回头看，我觉得总结的还不够好，还不便于理解。后来也是一直在继续想着怎么把指针的属性总结的再简单点、通俗易懂一点。正好这几天又想到一些东西，就写下来吧。希望这次挖掘出的5个指针属性，本文称“维度”，希望能帮助到学习指针的朋友。 本文中，我对指针总结的维度，用四个字来概括，就是：</span><span style="font-style: normal; font-weight: 700;">“两己三他”！</span><span style="font-style: normal; font-weight: 400;">是不是读起来一点都不顺口，一点都不押韵啊，什么个玩意儿。这</span><span style="font-style: normal; font-weight: 700;">“两己三他”</span><span style="font-style: normal; font-weight: 400;">，展开来说，就是：</span><span style="font-style: normal; font-weight: 700;">己址、己值、他值、他址、他型。</span></div><div><span style="font-style: normal; font-weight: 400;">我觉得可以从这5个维度再来聊聊指针。不过在聊之前，我写了个程序，把指针的</span><span style="font-style: normal; font-weight: 700;">“两己三他”</span><span style="font-style: normal; font-weight: 400;">维度都包含进来，然后再来一个一个解释每个维度的意思，你看看是不是这回事儿。</span></div><div><span style="font-style: normal; font-weight: 400;">在大部分的使用指针的场景下，这5个维度应该足够帮你去理解了。不过在一些使用指针特殊的场景下，可能5维度法帮助不了你。</span></div><div><span style="font-style: normal; font-weight: 400;">前方长文预警，若看的不耐烦了，可以收藏本文，有时间了接着看。</span></div><h2><span style="font-style: normal; font-weight: 700;">一、程序代码</span></h2><div><span style="font-style: normal; font-weight: 700;">1.1. 代码</span></div><div><span style="font-style: normal; font-weight: bold;">#include</span> <span style="font-style: normal; font-weight: 400;">&lt;stdio.h&gt;</span></div><div><br/></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">main</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">void</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">NULL</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;指针变量pInt自己的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: italic; font-weight: 400;">//printf(&quot;指针变量pInt自己的值是: 0X%x\n&quot;, pInt);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">para</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;变量para自己的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;变量para自己的值是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;指针变量pInt自己的值是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;指针变量pInt的他值是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">arr_int</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">};</span> <span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr_int</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_int第一个元素arr_int[0]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_int第二个元素arr_int[1]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">double</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pDouble</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">NULL</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">double</span> <span style="font-style: normal; font-weight: 400;">arr_double</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">1.1</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">2.2</span><span style="font-style: normal; font-weight: 400;">};</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">pDouble</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr_double</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_double第一个元素arr_double[0]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pDouble</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_double第二个元素arr_double[1]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pDouble</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">return</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">}</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 400;">运行的结果如下：</span></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 473px; height: 223px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><span style="font-style: normal; font-weight: 700;">我在自己的文章里讲我自己理解的一些东西时，我很喜欢用非常简单的程序来阐明。所以那些认为要用天书般的程序来阐明观点的，或者鄙视低水平程序的大牛们，请忽略我</span><span style="font-style: normal; font-weight: 400;">^_^。</span></div><div><span style="font-style: normal; font-weight: 700;">2.2. int型变量para</span></div><div><span style="font-style: normal; font-weight: 400;">程序中：</span></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">para</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;变量para自己的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;变量para自己的值是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">定义了变量para，它有自己的数据值，也有自己的存储地址，这些个都很好理解。从运行结果来看，变量para自己的数据值是16进制的“0X1”，地址是16进制的“0X22feb4”。换句话说，在内存中，地址为“0X22feb4”开始的存储空间，有4个字节存储了一个数据值“0X1”。在我的机器上，一个int型变量占用4个字节，在你的机器上可能与我不一样。</span></div><div><span style="font-style: normal; font-weight: 400;">关于int型变量para大家都好理解。下面，我来画一个示意图，来指明变量para在内存中存储的情况，如下：</span></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 436px; height: 265px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><span style="font-style: normal; font-weight: 400;">下面开始说说</span><span style="font-style: normal; font-weight: 700;">“两己三他”</span><span style="font-style: normal; font-weight: 400;">的概念。</span></div><h2><span style="font-style: normal; font-weight: 700;">二、两己三他</span></h2><div><span style="font-style: normal; font-weight: 700;">“两己三他”</span><span style="font-style: normal; font-weight: 400;">，展开来说，就是：</span><span style="font-style: normal; font-weight: 700;">己址、己值、他值、他址、他型。</span></div><div><span style="font-style: normal; font-weight: 700;">2.1. 己址</span></div><div><span style="font-style: normal; font-weight: 700;">2.1.1 “己址”的概念</span></div><div><span style="font-style: normal; font-weight: 700;">“己址”</span><span style="font-style: normal; font-weight: 400;">，就是</span><span style="font-style: normal; font-weight: 700;">“自己的地址”</span><span style="font-style: normal; font-weight: 400;">的简称。指针pInt作为一个变量，与int变量para一样，也需要存储在内存中的一段存储空间，这段存储空间也会有一个开始地址，也就是说，指针变量pInt也会有自己的地址。上面说了，变量para的地址是 “ 0X22feb4”，那么，指针变量pInt的地址是啥呢？</span></div><div><span style="font-style: normal; font-weight: 700;">2.1.2 “己址”的获取</span></div><div><span style="font-style: normal; font-weight: 400;">我们都学过，“&amp;”是一个取地址的运算符，在程序中：</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;指针变量pInt自己的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">就是通过“&amp;”来获取指针变量pInt的地址。从运行结果来看，指针变量pInt的地址是“0X22feb8”。在我的机器上，指针变量pInt也是占用4个字节，因此，指针变量pInt存储在开始地址是“0X22feb8”开始的4个字节空间。</span></div><div><span style="font-style: normal; font-weight: 700;">2.1.3 “己址”的代码写法</span></div><div><span style="font-style: normal; font-weight: 400;">在代码中，表示指针变量pInt的“己址”的代码写法，常见的是：</span></div><div><span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 700;">2.1.4 示意图</span></div><div><span style="font-style: normal; font-weight: 400;">现在，我们来完善那个示意图，图中加入指针变量pInt的“己址”，指出指针变量pInt在内存中是怎么个存储形式。</span></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 644px; height: 328px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 400;">“己址”，就是这个意思。你看，没什么特别难的吧！</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">2.2 己值</span></div><div><span style="font-style: normal; font-weight: 700;">2.2.1 “己值”的概念</span></div><div><span style="font-style: normal; font-weight: 700;">“己值”</span><span style="font-style: normal; font-weight: 400;">，就是</span><span style="font-style: normal; font-weight: 700;">“自己的数据值”</span><span style="font-style: normal; font-weight: 400;">的简称。指针pInt作为一个变量，跟变量para一样，也有着自己的数据值。</span></div><div><span style="font-style: normal; font-weight: 700;">2.2.2 “己值”的获取</span></div><div><span style="font-style: normal; font-weight: 400;">上面提到，变量para自己的数据值是“1”，那么指针变量pInt自己的数据值是多少。在程序中：</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;指针变量pInt自己的值是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">我通过“&amp;”运算符，将变量para的地址值赋给了指针变量pInt，通过printf来输出指针变量pInt的数据值。从运行结果中来看，指针变量pInt自己的数据值是“0X22feb4”。我们再看，变量para的地址也是“0X22feb4”，所以，</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">这个语句的本质，就是将变量para的地址，给了指针变量pInt的己值，这样就将指针变量pInt与变量para绑定在一起了。</span></div><div><span style="font-style: normal; font-weight: 400;">在“己址”中提到了，指针pInt的数据值存储在地址为“0X22feb8”开始的4个字节的内存上，那么也就是说，地址为“0X22feb8”开始的内存，后面的4个字节都用来存储着一个数据值“0X22feb4”。</span></div><div><span style="font-style: normal; font-weight: 700;">2.2.3 “己值”的代码写法</span></div><div><span style="font-style: normal; font-weight: 400;">在代码中，表示指针变量pInt的“己值”的代码写法，常见的有</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">也有的代码写法是：</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">N</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">-</span> <span style="font-style: normal; font-weight: 400;">N</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">这种写法的意思是用pInt的“己值”加上一个数字N或者减去一个数字N，这个等讲到“他型”这个属性时会提到。也有的写法是：</span></div><div><span style="font-style: normal; font-weight: 400;">pIntA</span> <span style="font-style: normal; font-weight: bold;">-</span> <span style="font-style: normal; font-weight: 400;">pIntB</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">这种写法表示的是两个指针变量用“己值”做减法。</span></div><div><span style="font-style: normal; font-weight: 700;">2.2.4 示意图</span></div><div><span style="font-style: normal; font-weight: 400;">现在，继续来完善上面的示意图，加入指针变量pInt的己值。</span></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 592px; height: 265px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><span style="font-style: normal; font-weight: 400;">所以，一般而言，“己值”对于指针变量pInt来讲，是自己的数据值；对其它的int类型的变量来讲，就是它们的地址。</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">2.3 他址</span></div><div><span style="font-style: normal; font-weight: 700;">2.3.1 “他址”的概念</span></div><div><span style="font-style: normal; font-weight: 700;">“他址”的概念</span><span style="font-style: normal; font-weight: 400;">就是</span><span style="font-style: normal; font-weight: 700;">“他人的地址”</span><span style="font-style: normal; font-weight: 400;">的意思。其实在上面提到己值时，就已经不那么明显地提到了“他址”的概念。</span></div><div><span style="font-style: normal; font-weight: 700;">2.3.2 “他址”的获取</span></div><div><span style="font-style: normal; font-weight: 400;">整型变量para存储在内存地址为&quot;0X22feb4&quot;开始的4个字节。在程序中，我通过</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">将变量para的地址给了指针变量pInt，这样就将指针变量pInt与变量para绑定在一起了。更为本质的说，是把</span><span style="font-style: normal; font-weight: 700;">“他人的地址”</span><span style="font-style: normal; font-weight: 400;">赋值给了指针变量pInt的“己值”，这里，</span><span style="font-style: normal; font-weight: 700;">“他人的地址”的“他”</span><span style="font-style: normal; font-weight: 400;">，指的就是变量para，</span><span style="font-style: normal; font-weight: 700;">“他人地址的址”的“址”</span><span style="font-style: normal; font-weight: 400;">，指的就是变量para的地址。注意，你看，</span><span style="font-style: normal; font-weight: 700;">”他址“和”己值“在数据值上是一样的</span><span style="font-style: normal; font-weight: 400;">，所以，你领悟出了什么东西来了没？</span></div><div><span style="font-style: normal; font-weight: 400;">很多教材所谓的“指针是一个地址变量，存储的是其它变量的地址”，说白了，就是在说</span><span style="font-style: normal; font-weight: 700;">“他址”</span><span style="font-style: normal; font-weight: 400;">这个维度的数据值等于</span><span style="font-style: normal; font-weight: 700;">“己值”</span><span style="font-style: normal; font-weight: 400;">这个维度的数据值，只是教材没说的那么明白。</span></div><div><span style="font-style: normal; font-weight: 700;">2.3.3 示意图</span></div><div><span style="font-style: normal; font-weight: 400;">再来完善那个示意图，这次加入“他址”的概念。</span></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 590px; height: 252px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">2.4 他值</span></div><div><span style="font-style: normal; font-weight: 700;">2.4.1 “他值”的概念</span></div><div><span style="font-style: normal; font-weight: 700;">“他值”，</span><span style="font-style: normal; font-weight: 400;">就是</span><span style="font-style: normal; font-weight: 700;">“他人的数据值”</span><span style="font-style: normal; font-weight: 400;">的意思。</span></div><div><span style="font-style: normal; font-weight: 700;">2.4.2 “他值”的获取</span></div><div><span style="font-style: normal; font-weight: 400;">在程序中，我通过</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: bold;">&amp;</span><span style="font-style: normal; font-weight: 400;">para</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">将变量para的地址给了指针变量pInt的“己值”，这样就将指针变量pInt与变量para绑定在一起了。这个时候，</span><span style="font-style: normal; font-weight: 700;">“他人的数据值”的“他”</span><span style="font-style: normal; font-weight: 400;">，指的就是变量para，</span><span style="font-style: normal; font-weight: 700;">“他人的数据值”的“数据值”</span><span style="font-style: normal; font-weight: 400;">，指的就是变量para的数据值“1”。在程序中，我通过</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;指针变量pInt的他值是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">也就是指针变量pInt前面加上</span><span style="font-style: normal; font-weight: 700;">“ * ”</span><span style="font-style: normal; font-weight: 400;">，来输出指针变量的”他值“，从运行结果来看，是“0X1”。 注意，你看，指针变量pInt的“他值”，与变量para的数据值是一样的，你又领悟到了什么？想不出来吗？继续看！</span></div><div><span style="font-style: normal; font-weight: 700;">2.4.3 “他值”的代码写法</span></div><div><span style="font-style: normal; font-weight: 400;">你经常在代码中看到的那些个代码写法，比如什么</span><span style="font-style: normal; font-weight: 700;">*pInt</span><span style="font-style: normal; font-weight: 400;">写法，是在表达什么意思啊，其实就是在计算指针变量pInt的“他值”啊！</span></div><div><span style="font-style: normal; font-weight: 400;">这些个写法呢：*(pInt + 1)、*pInt + 1、pInt[1]？</span></div><div><span style="font-style: normal; font-weight: 400;">*(pInt + 1)：如果把pInt + 1 看成是另外一个指针，比如</span></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pTemp</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">；</span></div><div><span style="font-style: normal; font-weight: 400;">那么*(pInt + 1)计算的本质上就是指针变量pTemp的“他值”；</span></div><div><span style="font-style: normal; font-weight: 400;">*pInt + 1：这个就是用pInt的“他值”加1；</span></div><div><span style="font-style: normal; font-weight: 400;">pInt[1]：这个呢？其实就是*(pInt + 1)。</span></div><div><span style="font-style: normal; font-weight: 700;">2.4.4 示意图</span></div><div><span style="font-style: normal; font-weight: 400;">继续完善上面的示意图，这次加入“他值”的概念：</span></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 660px; height: 279.8px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><h2><span style="font-style: normal; font-weight: 700;">2.5 他型</span></h2><div><span style="font-style: normal; font-weight: 700;">2.5.1 “他型”的概念</span></div><div><span style="font-style: normal; font-weight: 700;">“他型”，就是“他人的类型”的简称。</span><span style="font-style: normal; font-weight: 400;">在程序中，我们看到，声明指针变量pInt时这样写的：</span></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">NULL</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">指针变量pInt前面的” int &quot;并不是说指针变量pInt的“己值”是一个int类型的数据值；而是说，指针变量pInt的“他值”是一个“ int ”类型的数据值，此处指针变量pInt的“他值”是变量para的数据值“0X1”，因此，指针变量pInt前面的“int”指的就是数据值“0X1”是一个“int”型。</span></div><div><span style="font-style: normal; font-weight: 400;">总之一句话，声明指针时的类型是用来修饰“他值”的，而不是“己值”。</span></div><div><span style="font-style: normal; font-weight: 400;">你再看，在声明变量para的时候：</span></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">para</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">变量para前面的“int&quot;就是指变量para的类型是一个整型，此时的”int“对para来说是一个</span><span style="font-style: normal; font-weight: 700;">”自型“</span><span style="font-style: normal; font-weight: 400;">，也就是</span><span style="font-style: normal; font-weight: 700;">”自己的类型“</span><span style="font-style: normal; font-weight: 400;">的意思，只有指针在声明时的类型是</span><span style="font-style: normal; font-weight: 700;">”他型“</span><span style="font-style: normal; font-weight: 400;">，是</span><span style="font-style: normal; font-weight: 700;">“他人的类型”</span><span style="font-style: normal; font-weight: 400;">。</span></div><div><span style="font-style: normal; font-weight: 400;">既然”他型“是来修饰“他值”，那么在声明指针时还要加上这个“他型”有什么意义呢？继续看！</span></div><div><span style="font-style: normal; font-weight: 400;">在程序中，如下代码片段：</span></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">arr_int</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">};</span> <span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span></div><div><span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr_int</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_int第一个元素arr_int[0]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pInt</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_int第二个元素arr_int[1]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pInt</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">我把一个整型数组arr_int的地址赋给了指针变量pInt，那么pInt的“己址”没有变化，还是 0X22feb8，但是“己值”却变了。</span></div><div><span style="font-style: normal; font-weight: 400;">刚才指针变量pInt的“己值”还是“ 0X22feb4”，也就是变量para的地址，现在变成了“0X22feac”，这个可是数组arr_int第一个元素的地址。也就是说，指针变量pInt的“己址”不会改变，但是“己值”是可以被改变的。</span></div><div><span style="font-style: normal; font-weight: 400;">现在我们来看看“pInt”与“pInt + 1”的区别，这是在用pInt的“己值”在做运算。从运行结果来看，pInt的”己值“此时是”0X22feac“，而pInt + 1的”己值“是” 0X22feb0“，你发现了吗，两者正好相差4个字节，而一个“int”类型的数据也正好占用了4个字节。</span></div><div><span style="font-style: normal; font-weight: 400;">你可能会认为，既然pInt + 1是用“己值”加1，那么应该是”0X22feac + 1” = “0X22fead”才对啊，为什么不是这样呢？这就是指针变量pInt的“他型”搞的鬼。</span></div><div><span style="font-style: normal; font-weight: 400;">“他型”的意思，用大白话来说，就是：</span><span style="font-style: normal; font-weight: 700;">“我说 pInt 大兄弟啊，你的他值是个int型的数据值，你今后要是用你的己值 +1，+2，或者 -1，-2，可千万别傻乎乎的就真的加1个字节，加2个字节， 或者就真的减1个字节、减2个字节。人家int类型占4个字节，你就得按照4个字节为一个单位，去加 1* 4个字节 、2 * 4个字节，或者减去1 * 4个字节、2 * 4个字节，知道不？哦，顺便说下，pInt + N的N，可以为正数也可以为负数”</span><span style="font-style: normal; font-weight: 400;">。</span></div><div><span style="font-style: normal; font-weight: 400;">当然啦，如果你的机器上“int”型数据占8个字节，那么pInt + 1就是在“己值”上加8个字节，pInt + 2就是在“己值”上加 8 *2 = 16个字节，就这么个意思。</span></div><div><span style="font-style: normal; font-weight: 400;">我在程序中又举了个例子来说明这个“他型”。程序如下：</span></div><div><span style="font-style: normal; font-weight: bold;">double</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pDouble</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">NULL</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: bold;">double</span> <span style="font-style: normal; font-weight: 400;">arr_double</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">1.1</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">2.2</span><span style="font-style: normal; font-weight: 400;">};</span></div><div><span style="font-style: normal; font-weight: 400;">pDouble</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr_double</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_double第一个元素arr_double[0]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pDouble</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;arr_double第二个元素arr_double[1]的地址是: 0X%x</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pDouble</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">这次声明一个指针变量pDouble，它的“他型”是个“double”型，它的“己值”是数组arr_double的地址，它的“他值”是数组arr_double[0]这个元素的数据值“ 1.1 ”。在我的机器上，一个double型占用8个字节，那么pDouble + 1就是用pDouble 的“己值”加 1 * 8个字节，pDouble + 2就是用pDouble 的“己值” 加 2 * 8= 16个字节，pDouble - 1就是pDouble 的“己值”减去 1 * 8个字节，pDouble - 2就是pDouble 的“己值”减去 2 * 8 = 16个字节，我滴个乖乖！朋友们可以对着运行结果自己计算对不对！</span></div><div><br style="box-sizing:inherit;"/></div><h2><span style="font-style: normal; font-weight: 700;">3. 总结</span></h2><div><span style="font-style: normal; font-weight: 400;">是时候来总结下了。</span></div><div><span style="font-style: normal; font-weight: 400;">我声明一个指针变量：</span></div><div><span style="font-style: normal; font-weight: 400;">type</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pType</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">NULL</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">pType有5个维度，分别是：</span></div><div><span style="font-style: normal; font-weight: 400;">pType = (己址，己值，他址，他值，他型)；</span></div><div><span style="font-style: normal; font-weight: 700;">3.1</span> <span style="font-style: normal; font-weight: 700;">己址：即“自己的地址”</span></div><div><span style="font-style: normal; font-weight: 400;">指针变量pType作为一个变量，也有自己的地址，常见的代码写法是“&amp;pType ”。</span></div><div><span style="font-style: normal; font-weight: 400;">己址在一般的程序中不会被频繁地用到，如果要用的话，就涉及到“指针的指针”，这又是另外一个话题了，本文不讨论；</span></div><div><span style="font-style: normal; font-weight: 700;">3.2 己值：即“自己的数据值”</span></div><div><span style="font-style: normal; font-weight: 400;">指针变量pType 作为一个变量，也有自己的数据值，代码的写法是“pType ”。</span></div><div><span style="font-style: normal; font-weight: 400;">也可以在己值上做加减法运算，常见的代码写法有“pType + N”、“pType - N”、“pType2 - pType1”等。</span></div><div><span style="font-style: normal; font-weight: 700;">3.3 他址：即“他人的地址”</span></div><div><span style="font-style: normal; font-weight: 400;">指针变量pType的己值，意义除了表示自己的数据值外，还表示了与pType绑定在一起的“type”类型的变量的地址。一般而言，指针变量pType的“己值”与“他址”在数据值上是一样的。</span></div><div><span style="font-style: normal; font-weight: 400;">将一个type类型的变量与pType绑定在一起的常见方式是：pType = &amp;变量；</span></div><div><span style="font-style: normal; font-weight: 700;">3.4</span> <span style="font-style: normal; font-weight: 700;">他值：即“他人的数据值”</span></div><div><span style="font-style: normal; font-weight: 400;">一旦type类型的变量与pType绑定在一起，指针变量pType可以通过一些代码写法，来获取type类型变量的值，也就是“他值”。常见的代码写法有：“ *pType ”、“ pType-&gt; ”等。</span></div><div><span style="font-style: normal; font-weight: 400;">而这些代码的写法：“ *(pType + N) ”、“ *(pType - N) ”、“ pType[N]”也是获取的“他值”，不过需要特别说明一下：</span></div><div><span style="font-style: normal; font-weight: 400;">pType + N 你可以看成是：</span></div><div><span style="font-style: normal; font-weight: 400;">type</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pTemp</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">pType</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">N</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">“ *(pType + N) ”其实计算的就是指针变量pTemp的“他值”。</span></div><div><span style="font-style: normal; font-weight: 400;">“ *(pType - N) ” 你就好理解了吧；</span></div><div><span style="font-style: normal; font-weight: 400;">“ pType[N]”其实就是“ *(pType + N) ”，你就死记硬背吧。</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">3.5</span> <span style="font-style: normal; font-weight: 700;">他型：即“他人的类型”</span></div><div><span style="font-style: normal; font-weight: 400;">声明指针变量pType时，前面的“type”不是用来修饰pType 的“己值”的，而是用来修饰“他值”的，也就是说，“type”不是说pType的“己值”是一个type类型的数据值，而是指pType 的“他值”是一个type类型的数据值。</span></div><div><span style="font-style: normal; font-weight: 400;">“他型”在代码中的作用，主要是计算“pType + N”、“pType - N”时，pType要加上或者减去 ( N * sizeof(type) )个字节。</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 400;">指针总是让人晕晕的，很可能就是让你晕在这5个维度里的一个或者几个上。把这5个维度好好理解透，指针啊，只是个纸老虎。</span></div><div><br style="box-sizing:inherit;"/></div><h2><span style="font-style: normal; font-weight: 700;">4. 习题讲解</span></h2><div><span style="font-style: normal; font-weight: 400;">讲完了5个维度，不来点上手习题怎么行。下面列举几个习题，都是跟指针有关的，都是让初学者晕的歇菜的。我用这5个维度来解读这些题，你看看是不是要轻松一点！</span></div><div><span style="font-style: normal; font-weight: 700;">4.1 数组元素求和</span></div><div><span style="font-style: normal; font-weight: 700;">4.1.1 程序</span></div><div><span style="font-style: normal; font-weight: 400;">第一个例题是很常见的程序，就是求一个数组元素的和，程序如下：</span></div><div><span style="font-style: normal; font-weight: bold;">#include</span> <span style="font-style: normal; font-weight: 400;">&lt;stdio.h&gt;</span></div><div><br/></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">main</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">void</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">NULL</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">sum</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">]</span><span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">1</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">2</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">};</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;数组元素是: &quot;</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">for</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">&lt;</span> <span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: bold;">++</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%d &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pArr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">]);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">}</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">for</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">&lt;</span> <span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: bold;">++</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">sum</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">sum</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">}</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;数组元素和是: %d</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">sum</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">return</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">}</span></div><div><span style="font-style: normal; font-weight: 400;">程序很简单，先是输出数组的所有元素，然后计算出数组所有元素的和。运行结果如下：</span></div><div><br style="box-sizing:inherit;"/></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 471px; height: 113px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><br style="box-sizing:inherit;"/></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">4.1.2 “两己三他”的解读</span></div><div><span style="font-style: normal; font-weight: 700;">4.1.2.1 输出数组元素</span></div><div><span style="font-style: normal; font-weight: 400;">在输出数组元素时，代码如下：</span></div><div><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%d &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pArr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">]);</span></div><div><span style="font-style: normal; font-weight: 400;">这句代码等同于</span></div><div><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%d &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">(</span> <span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">));</span></div><div><span style="font-style: normal; font-weight: 400;">这里面使用了”己值“、“他型”做了加法运算，使用了”他值“获取数组元素。</span></div><div><span style="font-style: normal; font-weight: 700;">”己值“：</span><span style="font-style: normal; font-weight: 400;">代码先是将数组名 arr的数据值赋值给了pArr的“己值”。而数组名arr的数据值是啥啊，是arr[0]元素的地址，对吧！那么pArr的己值，也是arr[0]的地址，对吧！这样一来，pArr就和arr[0]绑定起来了。</span></div><div><span style="font-style: normal; font-weight: 400;">至于( pArr + index)的意思呢，你就看成有一个间接的、临时的指针变量pTemp：</span></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pTemp</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">也就是说，pArr + index其实也是一个指针pTemp，只不过这个pTemp的己值是pArr的己值加上 index * sizeof(int) 个字节数。</span></div><div><span style="font-style: normal; font-weight: 700;">“他型”：pArr的他型是“int”型</span><span style="font-style: normal; font-weight: 400;">，pArr + index，是在pArr己值的基础上，加多少个字节呢？pArr的他型是int型，那么pArr + index，是不是意味着pArr的己值加上 index * sizeof(int) 个字节啊！</span></div><div><span style="font-style: normal; font-weight: 400;">pArr：可以写成pArr + 0，就是加上 0 * 4 = 0个字节，此时pTemp的己值是arr[0]的地址；</span></div><div><span style="font-style: normal; font-weight: 400;">pArr + 1：就是加上1 * 4 = 4 个字节，此时pTemp的己值是arr[1]的地址；</span></div><div><span style="font-style: normal; font-weight: 400;">pArr + 2：就是加上2 * 4 = 8 个字节，此时pTemp的己值是arr[2]的地址；</span></div><div><span style="font-style: normal; font-weight: 400;">这样，pArr + index就遍历到了数组所有元素的地址了。</span></div><div><span style="font-style: normal; font-weight: 400;">你会发现，pTemp的己值，一直在发生变化；pArr的己值和己址，一直未变。</span></div><div><span style="font-style: normal; font-weight: 700;">“他值”：</span><span style="font-style: normal; font-weight: 400;">既然pArr + index能够遍历到数组所有元素的地址，再使用 *(pArr + index) ，也就是*pTemp，是不是就能获取到pTemp的他值了，这样也就变量到数组所有元素的值了！</span></div><div><span style="font-style: normal; font-weight: 700;">4.1.2.2 数组元素求和</span></div><div><span style="font-style: normal; font-weight: 400;">求数组元素的和时，使用的代码如下：</span></div><div><span style="font-style: normal; font-weight: 400;">sum</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">sum</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">根据刚才我对输出数组元素的分析，这句代码中pArr是怎么玩的，大家也清楚了吧！</span></div><div><span style="font-style: normal; font-weight: 400;">pArr + index依然是在用pArr的己值做加法运算，获取到一个临时指针pTemp的己值，这个pTemp的己值是每个数组元素的地址；</span></div><div><span style="font-style: normal; font-weight: 400;">再用 *(pArr + inedx)，也就是*pTemp， 获取临时指针pTemp的他值，也就是每个元素的值。</span></div><div><span style="font-style: normal; font-weight: 400;">最后将pTemp的每一个他值，叠加起来，算出数组元素的和。</span></div><div><span style="font-style: normal; font-weight: 700;">4.1.2.3 总结</span></div><div><span style="font-style: normal; font-weight: 400;">大家试着用“两己三他”的维度去理解pArr、pArr + index、*(pArr + index)、pArr[index]、*pArr + index等常见的代码写法！</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">4.2 指针数组</span></div><div><span style="font-style: normal; font-weight: 400;">指针数组是将指针与数组结合起来的东东，对于初学者朋友而言，会比较难理解。指针数组是一个比较大的话题，相关概念请参见一般的C语言教材，这里只是用”两己三他“的概念来解释程序中的指针部分概念。</span></div><div><span style="font-style: normal; font-weight: 700;">4.2.1 程序</span></div><div><span style="font-style: normal; font-weight: 400;">指针数组，我举了一个例子如下：</span></div><div><span style="font-style: normal; font-weight: bold;">#include</span> <span style="font-style: normal; font-weight: 400;">&lt;stdio.h&gt;</span></div><div><br/></div><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: bold;">main</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">void</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">&quot;abc&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">&quot;def&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">&quot;ghi&quot;</span><span style="font-style: normal; font-weight: 400;">};</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">];</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;字符串数组arr的每个字符串元素是: &quot;</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">for</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">&lt;</span> <span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: bold;">++</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%s &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">]);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">}</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;字符串数组arr第一个字符串的每个元素是: &quot;</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">for</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span> <span style="font-style: normal; font-weight: bold;">&lt;</span> <span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">;</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: bold;">++</span><span style="font-style: normal; font-weight: 400;">)</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">{</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%c &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">)</span> <span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">}</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">\n</span><span style="font-style: normal; font-weight: 400;">&quot;</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><br/></div><div><span style="font-style: normal; font-weight: 400;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">return</span> <span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">}</span></div><div><span style="font-style: normal; font-weight: 400;">运行结果如下：</span></div><div><br style="box-sizing:inherit;"/></div><div style="box-sizing: inherit; -webkit-box-orient: vertical; -webkit-box-direction: normal; flex-direction: column; -webkit-box-align: stretch; align-items: stretch; flex-shrink: 0; position: relative; width: 460px; height: 111px; overflow: hidden; background: rgb(247, 248, 250); max-width: 100%; margin: 0.72em auto; cursor: -webkit-zoom-in;"/><div><br style="box-sizing:inherit;"/></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">4.2.2 ”两己三他“的解读</span></div><div><span style="font-style: normal; font-weight: 700;">4.2.2.1 输出所有的字符串</span></div><div><span style="font-style: normal; font-weight: 400;">先看指针数组的定义：</span></div><div><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">&quot;abc&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">&quot;def&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">&quot;ghi&quot;</span><span style="font-style: normal; font-weight: 400;">};</span></div><div><span style="font-style: normal; font-weight: 400;">你看到的这个数组的每个元素好像是一个字符串，其实本质上是这样的：</span></div><div><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pChar1</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">&quot;abc&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pChar2</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">&quot;def&quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pChar3</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">&quot;ghi&quot;</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">3</span><span style="font-style: normal; font-weight: 400;">]</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">{</span><span style="font-style: normal; font-weight: 400;">pChar1</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pChar2</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pChar3</span><span style="font-style: normal; font-weight: 400;">};</span></div><div><span style="font-style: normal; font-weight: 400;">数组arr的每个元素其实是一个“他型”是“char”的指针。</span></div><div><span style="font-style: normal; font-weight: 400;">arr[0]就是pChar1这个指针，那么pChar1的己值或者他址是啥，当然是字符串”abc“的字符‘a&apos;的地址，那么：</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%s &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">]);</span></div><div><span style="font-style: normal; font-weight: 400;">本质上是：</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%s &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: 400;">pChar1</span><span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">使用pChar1的己值或者他址，从字符&apos;a&apos;的地址开始，一个一个地输出后面的&apos;b&apos;和&apos;c&apos;。</span></div><div><span style="font-style: normal; font-weight: 400;">对于pChar2和pChar3也是一样地理解。</span></div><div><span style="font-style: normal; font-weight: 700;">4.2.2.2 输出第一个字符串“abc”的每个字符</span></div><div><span style="font-style: normal; font-weight: 400;">代码如下：</span></div><div><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">arr</span><span style="font-style: normal; font-weight: 400;">[</span><span style="font-style: normal; font-weight: 400;">0</span><span style="font-style: normal; font-weight: 400;">];</span></div><div><span style="font-style: normal; font-weight: 400;">printf</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">&quot;%c &quot;</span><span style="font-style: normal; font-weight: 400;">,</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">(</span><span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">)</span> <span style="font-style: normal; font-weight: 400;">);</span></div><div><span style="font-style: normal; font-weight: 400;">将arr[0]，也就是pChar1的己值给了pArr的己值，那么pArr的己值和他址都是字符&apos;a&apos;的地址。</span></div><div><span style="font-style: normal; font-weight: 400;">pArr + index 是在pArr的己值上，加上 index * sizeof(char) 个字节，给了一个临时指针变量pTemp：</span></div><div><span style="font-style: normal; font-weight: bold;">char</span> <span style="font-style: normal; font-weight: bold;">*</span><span style="font-style: normal; font-weight: 400;">pTemp</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">pArr</span> <span style="font-style: normal; font-weight: bold;">+</span> <span style="font-style: normal; font-weight: 400;">index</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">这个指针pTemp的己值或者他址，会依次为字符&apos;a&apos;, &apos;b&apos;, &apos;c&apos;的地址，也就是pTemp的他值也会依次为字符&apos;a&apos;, &apos;b&apos;,&apos;c&apos;，这样指针pTemp就会依次遍历到字符串“abc”的每一个字符了。</span></div><div><br style="box-sizing:inherit;"/></div><div><span style="font-style: normal; font-weight: 700;">4.3 链表</span></div><div><span style="font-style: normal; font-weight: 400;">链表是使用指针最为频繁的，什么插入节点、删除节点等，都会遇到如下的代码写法：</span></div><div><span style="font-style: normal; font-weight: 400;">p2</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">p1</span><span style="font-style: normal; font-weight: bold;">-&gt;</span><span style="font-style: normal; font-weight: 400;">next</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">p1</span><span style="font-style: normal; font-weight: bold;">-&gt;</span><span style="font-style: normal; font-weight: 400;">next</span> <span style="font-style: normal; font-weight: bold;">=</span> <span style="font-style: normal; font-weight: 400;">p3</span><span style="font-style: normal; font-weight: bold;">-&gt;</span><span style="font-style: normal; font-weight: 400;">next</span><span style="font-style: normal; font-weight: 400;">;</span></div><div><span style="font-style: normal; font-weight: 400;">......</span></div><div><span style="font-style: normal; font-weight: 400;">这TM什么玩意儿，晕的一腿啊！这个next指针，那个next指针，跳来跳去的，我了个去，头脑已经充满浆糊了。呵呵，指针5维度分析法来了！不过，关于链表，我觉得还是另外开辟一个文章讲吧。等把链表讲完，回头再讲这些个next指针，我跟你讲，链表的本质也就那样，你懂了之后，链表比指针还要纸老虎。</span></div><p style="box-sizing:inherit;margin:20px 0px;"/><p style="box-sizing:inherit;margin:20px 0px;"/><p style="box-sizing:inherit;margin:20px 0px;"/><p style="box-sizing:inherit;margin:20px 0px;"/><p style="box-sizing:inherit;margin:20px 0px;"/></div><div><br/></div><div><br/></div><div><a href="http://blog.csdn.net/yanzi1225627/article/details/40518223" style="text-decoration-line: none;">C/C++拾遗(一):关于数组的指针和数组元素首地址的一道经典题</a></div><div style="-evernote-webclip:true;"><div><span style="font-style: normal; font-weight: normal;">.</span></div><div>.</div><div style="-en-paragraph:true;">版权声明：本文为博主原创文章，未经博主允许不得转载。</div><div style="-en-paragraph:true;"><span style="font-style: normal; font-weight: normal;">代码如下：</span></div><div><div><span style="font-style: normal; font-weight: bold;">[cpp]</span> <a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="view plain">view plain</a> <a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="copy">copy</a></div><div align="center" style="background-color:rgb(255, 255, 255);"/><div><a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="print">print</a><a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="?">?</a></div><ol start="1"><li><div><span style="font-style: normal; font-weight: normal;">#include &lt;stdio.h&gt;</span> <span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">main(</span><span style="font-style: normal; font-weight: bold;">void</span><span style="font-style: normal; font-weight: normal;">) &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">&nbsp;a[5] =&nbsp;{1, 2, 3, 4, 5}; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">&nbsp;*ptr =&nbsp;(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*)(&amp;a+1); &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*p1 =&nbsp;a; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*p2 =&nbsp;&amp;a[0]; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*p3 =&nbsp;(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*)(&amp;a); &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;<span style="font-style: normal; font-weight: bold;">if</span><span style="font-style: normal; font-weight: normal;">(p1 == p2){ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p1 == p2\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;}<span style="font-style: normal; font-weight: bold;">else</span><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p1 != p2\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;} &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;<span style="font-style: normal; font-weight: bold;">if</span><span style="font-style: normal; font-weight: normal;">(p1 == p3){ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p1 == p3\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;}<span style="font-style: normal; font-weight: bold;">else</span><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p1 != p3\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;} &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;<span style="font-style: normal; font-weight: bold;">if</span><span style="font-style: normal; font-weight: normal;">(p2 == p3){ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p2 == p3\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;}<span style="font-style: normal; font-weight: bold;">else</span><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p2 != p3\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;} &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;%d %d\n&quot;</span><span style="font-style: normal; font-weight: normal;">,*(a+1),*(ptr-1)); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*p4 =&nbsp;++p1; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*p5 =&nbsp;++p3; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;<span style="font-style: normal; font-weight: bold;">if</span><span style="font-style: normal; font-weight: normal;">(p4 == p5){ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p4 == p5\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;}<span style="font-style: normal; font-weight: bold;">else</span><span style="font-style: normal; font-weight: normal;">{ &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp;printf(<span style="font-style: normal; font-weight: normal;">&quot;p4 != p5\n&quot;</span><span style="font-style: normal; font-weight: normal;">); &nbsp;</span></span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;} &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">&nbsp; &nbsp;</span><span style="font-style: normal; font-weight: bold;">return</span> <span style="font-style: normal; font-weight: normal;">0; &nbsp;</span></div></li><li><div><span style="font-style: normal; font-weight: normal;">} &nbsp;</span></div></li></ol></div><div><br/></div><div><span style="font-style: normal; font-weight: normal;">最终输出结果如下：</span></div><div style="-en-paragraph:true;"><span style="font-style: normal; font-weight: bold;">里面所有的判断都是相等，打印的两个值是2和5.</span></div><div style="-en-paragraph:true;"><span style="font-style: normal; font-weight: normal;">原因如下：</span></div><div style="-en-paragraph:true;"><span style="font-style: normal; font-weight: normal;">&amp;a是数组的首地址，它的类型是int(*)[5]，因此+1是加的是数组个数的步长。<span style="font-style: normal; font-weight: normal;"><span style="font-style: normal; font-weight: bold;">指针加1要根据指针自身类型加上一定的值， 不同类型的指针+1之后增加的大小不同</span>。因此&amp;a + 1后指向的地址对数组来说是越界的，注意前面有个int(*)又强制将他转为int*了。因此计算*(ptr - 1)的时候，ptr是个int类型的指针，减一等于往左移动sizeof(int*)个字节，因此又指向a[4]了，他的值等于&amp;a[4].</span></span></div><div style="-en-paragraph:true;"><span style="font-style: normal; font-weight: normal;">为此杂家又对p4和p5作了验证，为啥结果p4会等于p5呢？原因就在于申请p3的时候对&amp;a进行了强制类型转换，</span></div><div><div><span style="font-style: normal; font-weight: bold;">[cpp]</span> <a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="view plain">view plain</a> <a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="copy">copy</a></div><div align="center" style="background-color:rgb(255, 255, 255);"/><div><a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="print">print</a><a href="http://blog.csdn.net/yanzi1225627/article/details/40518223#" style="font-style: normal; font-weight: normal; text-decoration: none;" target="_blank" title="?">?</a></div><ol start="1"><li><div><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*p3 =&nbsp;(</span><span style="font-style: normal; font-weight: bold;">int</span> <span style="font-style: normal; font-weight: normal;">*)(&amp;a); &nbsp;</span></div></li></ol></div><div style="-en-paragraph:true;"><span style="font-style: normal; font-weight: normal;"><span style="font-style: normal; font-weight: bold;">如果不加这个转换，是编译不过去的</span>。加了转换之后p3等于p1也等于p2，他的类型跟另外两个一样都是int*类型的了，因此移动相同位后地址也是一样的。很多人纠结就纠结在&amp;a、a、&amp;a[0]，根本原因在于对&amp;a进行了强制类型(int*)转换。</span></div></div><div><br/></div></div><div><br/></div>